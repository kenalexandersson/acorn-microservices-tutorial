= Spring Cloud
:toc: left
:imagesdir: images

ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

== Gateway
 `items-service` and `reviews-service`

image::overview-7-gateway.png[]


=== Creating the project

[quote]
____
. Go to https://start.spring.io/ (or use IntelliJ `New -> Module... -> Spring Initializr`)
. Enter the following values in fields:
.. `Group:` com.acorn.tutorial
.. `Artifact:` gateway
. Add dependencies (search for them and select):
.. Spring Config Client
.. Eureka Discovery Client
.. Spring Web
.. Spring Boot Actuator
.. Lombok
. Click `Generate the project`
. If using https://start.spring.io: open the resulting zip and copy the items-service directory to the root of the project (acorn-microservices-tutorial)
____

[TIP]
====
Let's remove some autogenerated files we don't need, delete the following files from project:

- gateway/.mvn (the whole dir)
- gateway/.gitignore
- gateway/HELP.md
- gateway/mvnw
- gateway/mvnw.cmd
====

Next edit the parent pom.xml so that it becomes aware of the child project:
[quote]
____
. Open `acorn-microservices-tutorial/pom.xml`
. Add `gateway` to the modules list in the parent pom:
+
[source,xml]
----
    ...

    <modules>
        <module>config-server</module>
        <module>service-discovery-server</module>
        <module>items-service</module>
        <module>reviews-service</module>
        <module>webapi</module>
        <module>gateway</module>
    </modules>

    ...
----
____

Build the project to verify that all is glued together correctly, and for downloading dependencies:
[source, bash]
----
# Run mvn clean install from the acorn-microservices-tutorial directory
mvn clean install -DskipTests
----

Note that you must run the command with the flag `-DskipTests`, if not an autogenerated Spring test will fail.

Expected outcome after running the command:

[source]
----
[INFO] Reactor Summary:
[INFO]
[INFO] acorn-microservices-tutorial ....................... SUCCESS [  1.513 s]
[INFO] config-server ...................................... SUCCESS [  3.292 s]
[INFO] service-discovery-server ........................... SUCCESS [  2.063 s]
[INFO] items-service ...................................... SUCCESS [  3.377 s]
[INFO] reviews-service .................................... SUCCESS [  4.808 s]
[INFO] webapi ............................................. SUCCESS [  3.980 s]
[INFO] gateway ............................................ SUCCESS [  1.980 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
----

<<microservices-8.adoc#,Nextup: Distributed tracing>>

